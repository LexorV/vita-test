import{Q}from"./QPage-DSBNIFOy.js";import{C as _,r as m,t as q,x as g,y as b,z as l,A as e,M as V,L as i,P as d,Q as h,K as C,S as f,D as w}from"./index-DlmhaCa1.js";import{f as S,i as R,h as c,j as p,g as U,k,_ as B}from"./CommentForm.vue_vue_type_style_index_0_scoped_fe3fdbb5_lang-OKrdhW-x.js";import{api as I}from"./axios-CBiA5BwK.js";const F=_({__name:"UserForm",setup(v){const n=m(null),o=m(!1),x=C(),t=q({blogName:"",fullName:""}),u={required:a=>a&&a.toString().trim().length>0||"Обязательное поле",max50:a=>!a||a.length<=50||"Максимум 50 символов"};async function N(){if(!n.value)return;const a=n.value.validate();if(typeof a=="boolean"?a:await a){o.value=!0;try{const r={blogName:t.blogName.trim(),fullName:t.fullName.trim()};await I.post("/userInfo",r),f.create({type:"positive",message:"Пользователь создан"}),await x.push("/users"),y()}catch(r){console.error(r),f.create({type:"negative",message:"Ошибка создания пользователя"})}finally{o.value=!1}}}function y(){t.blogName="",t.fullName=""}return(a,s)=>(b(),g(S,{flat:"",bordered:"",class:"q-pa-md form-card"},{default:l(()=>[e(R,{ref_key:"formRef",ref:n,class:"q-gutter-md",onSubmit:V(N,["prevent"])},{default:l(()=>[e(c,{class:"q-pb-none"},{default:l(()=>s[2]||(s[2]=[i("div",{class:"row items-start"},[i("div",null,[i("div",{class:"text-h6"},"Создание пользователя"),i("div",{class:"text-caption text-grey"},"Заполните поля ниже")])],-1)])),_:1,__:[2]}),e(c,null,{default:l(()=>[e(p,{modelValue:t.blogName,"onUpdate:modelValue":s[0]||(s[0]=r=>t.blogName=r),label:"Название блога",outlined:"",clearable:"",rules:[u.required,u.max50],disable:o.value,maxlength:50},{prepend:l(()=>[e(d,{name:"campaign"})]),_:1},8,["modelValue","rules","disable"]),e(p,{modelValue:t.fullName,"onUpdate:modelValue":s[1]||(s[1]=r=>t.fullName=r),label:"Полное имя",outlined:"",clearable:"",rules:[u.required,u.max50],disable:o.value,maxlength:50,class:"q-mt-md"},{prepend:l(()=>[e(d,{name:"person"})]),_:1},8,["modelValue","rules","disable"])]),_:1}),e(U,{inset:""}),e(k,{align:"right"},{default:l(()=>[e(h,{label:"Создать",type:"submit",color:"secondary",loading:o.value},null,8,["loading"])]),_:1})]),_:1},512)]),_:1}))}}),P=B(F,[["__scopeId","data-v-f73c83c8"]]),z=_({__name:"CreateUserPage",setup(v){return(n,o)=>(b(),g(Q,{class:"q-pa-md flex flex-center"},{default:l(()=>[e(w(P))]),_:1}))}});export{z as default};
