import{Q as S}from"./QPage-E6m2kMPU.js";import{C as g,N as y,a as k,x as m,y as o,z as _,A as p,L as c,G as f,Q as w,F as v,J as N,I as Q,K as B,D as h,n as b,O as P,w as I,o as q,S as A}from"./index-BGG8ARpm.js";import{f as D,h as L,g as R,e as F,_ as T}from"./CommentForm.vue_vue_type_style_index_0_scoped_fe3fdbb5_lang-BO4EKOmR.js";import"./axios-BCEhPGnj.js";import{u as U}from"./post-store-pG-4j5Yg.js";import{u as C}from"./user-store-kO2ggb_W.js";import{P as V}from"./PostComponent-VAdvBLUv.js";const $={class:"text-h5"},j={class:"text-caption text-grey-7"},z={class:"row items-center q-gutter-sm"},E={class:"text-caption text-grey-6"},G={key:1,class:"q-pa-md text-grey-6"},J=g({__name:"UserCard",setup(x){const u=C(),{currentUser:s}=y(u),e=k(()=>s.value),r=U(),i=B();function t(){r.setTargetUserId(e.value.id),i.push({path:"/create-post"})}function a(n){const d=e.value.post.filter(l=>l.id!==n);e.value.post.splice(0,e.value.post.length,...d)}return(n,d)=>(o(),m(D,{class:"q-mb-lg"},{default:_(()=>[p(L,{class:"row items-center justify-between"},{default:_(()=>[c("div",null,[c("div",$,f(e.value.blogName),1),c("div",j,"Автор: "+f(e.value.fullName),1)]),c("div",z,[c("div",E,"Записей: "+f(e.value.post?.length??0),1),p(w,{color:"primary",icon:"add",label:"Создать пост",dense:"",onClick:t})])]),_:1}),p(R),p(F,{separator:""},{default:_(()=>[e.value.post&&e.value.post.length?(o(!0),v(Q,{key:0},N(e.value.post,l=>(o(),m(h(V),{key:l.id,post:l,author:e.value.fullName,"show-actions":!0,onDeleted:a},null,8,["post","author"]))),128)):(o(),v("div",G,"У пользователя пока нет записей"))]),_:1})]),_:1}))}}),K=T(J,[["__scopeId","data-v-7c0b5511"]]),M={key:1,class:"q-pa-md"},te=g({__name:"UserPage",setup(x){const u=P(),s=C(),{hasCurrentUser:e}=y(s),r=U();async function i(t){const a=Array.isArray(t)?t[0]:t;if(!a)return;const n=Number(a);if(!s.currentUser||s.currentUser.id!==n){if(!r.isLoaded)try{await r.fetchAllPosts()}catch{A.create({type:"negative",message:"Не удалось загрузить список записей"})}const d=r.getUserById(n);s.setCurrentUser(d)}}return b(()=>{i(u.params.id)}),I(()=>u.params.id,t=>{i(t)}),q(()=>{s.clearCurrentUser()}),(t,a)=>(o(),m(S,{padding:""},{default:_(()=>[h(e)?(o(),m(h(K),{key:0})):(o(),v("div",M,"Пользователь не найден"))]),_:1}))}});export{te as default};
