import{Q as $}from"./QPage-DSBNIFOy.js";import{C as g,a as b,K as q,F as u,y as r,I as f,A as n,z as y,L as t,G as d,Q as h,M as w,r as p,n as U,H as v,J as Q,x,D as C}from"./index-DlmhaCa1.js";import{f as B,g as N,_ as D,e as I}from"./CommentForm.vue_vue_type_style_index_0_scoped_fe3fdbb5_lang-OKrdhW-x.js";import{api as k}from"./axios-CBiA5BwK.js";import{u as L}from"./user-store-BGc-YR5W.js";const M={class:"row items-center justify-between"},S={class:"col"},V={class:"text-h6"},j={class:"text-subtitle2 text-grey-7"},A={class:"col-auto"},F={class:"q-mt-sm text-caption text-grey-6"},P=g({__name:"UserComponent",props:{user:{}},emits:["deleted"],setup(_,{emit:s}){const a=s,l=_,e=b(()=>l.user);async function m(){try{await k.delete(`/userInfo/${e.value.id}`),a("deleted",e.value.id)}catch(i){console.error("Не удалось удалить пользователя",i)}}const o=q();function c(){L().setCurrentUser(e.value),o.push({path:`/user/${e.value.id}`})}return(i,O)=>(r(),u(f,null,[n(B,{class:"user-card q-pa-md q-mb-md",onClick:c},{default:y(()=>[t("div",M,[t("div",S,[t("div",V,d(e.value.fullName),1),t("div",j,"@"+d(e.value.blogName),1)]),t("div",A,[n(h,{color:"negative",icon:"delete",flat:"",dense:"",onClick:w(m,["stop"])})])]),t("div",F,"Постов: "+d(e.value.post?.length??0),1)]),_:1}),n(N,{spaced:""})],64))}}),z=D(P,[["__scopeId","data-v-4fe9a3fb"]]),E={class:"q-pa-md"},G={class:"row items-center justify-between q-mb-md"},H={class:"row items-center"},J={key:0,class:"q-pa-md text-grey"},K={key:1,class:"q-pa-md"},R={key:2,class:"q-pa-md text-negative"},T=g({__name:"UserList",setup(_){const s=p([]),a=p(!1),l=p(null);async function e(){a.value=!0,l.value=null;try{const o=await k.get("/userInfo/findAll");s.value=o.data??[]}catch(o){console.error(o),l.value="Не удалось загрузить пользователей"}finally{a.value=!1}}function m(o){s.value=s.value.filter(c=>c.id!==o)}return U(e),(o,c)=>(r(),u(f,null,[t("div",E,[t("div",G,[c[0]||(c[0]=t("div",{class:"text-h6"},"Пользователи",-1)),t("div",H,[n(h,{color:"primary",label:"Создать пользователя",class:"q-mr-sm",to:{path:"/create-user"}}),n(h,{outline:"",color:"primary",label:"Обновить",onClick:e,loading:a.value},null,8,["loading"])])]),n(I,{separator:""},{default:y(()=>[(r(!0),u(f,null,Q(s.value,i=>(r(),x(C(z),{key:i.id,user:i,onDeleted:m},null,8,["user"]))),128))]),_:1})]),!a.value&&s.value.length===0?(r(),u("div",J,"Список пуст")):v("",!0),a.value?(r(),u("div",K,"Загрузка...")):v("",!0),l.value?(r(),u("div",R,d(l.value),1)):v("",!0)],64))}}),te=g({__name:"UsersPage",setup(_){return(s,a)=>(r(),x($,{padding:""},{default:y(()=>[n(C(T))]),_:1}))}});export{te as default};
