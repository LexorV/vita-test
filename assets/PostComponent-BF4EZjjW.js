import{C as w,K as C,r as b,T as I,y as d,x,z as p,A as a,L as s,G as o,B,M as r,F as P,H as S,Q as u,U as T}from"./index-DlmhaCa1.js";import{m as $,n as q,_ as A}from"./CommentForm.vue_vue_type_style_index_0_scoped_fe3fdbb5_lang-OKrdhW-x.js";import{api as D}from"./axios-CBiA5BwK.js";import{u as N}from"./post-store-BkoIMGwp.js";import{u as Q}from"./user-store-BGc-YR5W.js";const U={class:"row items-center justify-between q-mb-xs"},V={class:"col"},E={class:"text-subtitle1"},j={class:"text-caption"},F={class:"col-auto text-caption text-grey-6"},M={class:"text-body2"},R={class:"row items-center justify-between q-mt-sm"},z={class:"text-caption text-grey-7"},G={key:0,class:"row items-center q-gutter-sm"},H=w({__name:"PostComponent",props:{post:{},author:{},userId:{},showActions:{type:Boolean}},emits:["deleted"],setup(m,{emit:h}){const e=m,f=h,i=C(),c=N(),_=Q(),n=b(!1);function v(){c.setEditInitialFromPost(e.post),i.push({path:`/change-post/${e.post.id}`})}function y(){i.push({path:`/post/${e.post.id}`})}function g(){if(e.userId!=null){const t=c.getUserById(e.userId);t?(_.setCurrentUser(t),i.push({path:`/user/${e.userId}`})):i.push({path:`/user/${e.userId}`})}}async function k(){if(!n.value){n.value=!0;try{await D.delete(`/post/${e.post.id}`),f("deleted",e.post.id)}catch(t){console.error("Не удалось удалить пост",t)}finally{n.value=!1}}}return(t,l)=>I((d(),x($,{class:"q-py-md post-clickable",clickable:"",onClick:y},{default:p(()=>[a(q,null,{default:p(()=>[s("div",U,[s("div",V,[s("div",E,o(t.post.title),1),s("div",j,[l[0]||(l[0]=B(" Автор: ",-1)),s("span",{class:"author-link",onClick:r(g,["stop"])},o(t.author),1)])]),s("div",F,"Дата: "+o(t.post.dateTime),1)]),s("div",M,o(t.post.briefDescription),1),s("div",R,[s("div",z,"Комментариев: "+o(t.post.comments?.length??0),1),t.showActions?(d(),P("div",G,[a(u,{color:"primary",icon:"edit",label:"Редактировать",outline:"",dense:"",onClick:r(v,["stop"])}),a(u,{color:"negative",icon:"delete",label:"Удалить",flat:"",dense:"",onClick:r(k,["stop"]),loading:n.value},null,8,["loading"])])):S("",!0)])]),_:1})]),_:1})),[[T]])}}),X=A(H,[["__scopeId","data-v-45212df9"]]);export{X as P};
